<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ورشة - متجر علي بابا أحمد الدكروري</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
   :root {
      --primary-color: #1a237e; /* أزرق داكن */
      --secondary-color: #283593; /* أزرق متوسط */
      --accent-color: #ffd700; /* ذهبي */
      --light-color: #e8eaf6; /* أزرق فاتح */
      --dark-color: #0d47a1; /* أزرق غامق */
      --text-color: #ffffff;
      --shadow: 0 4px 12px rgba(0,0,0,0.15);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }
    
    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background-color: #f5f5f5;
      color: #333;
      overflow-x: hidden;
      line-height: 1.6;
    }
    
    header {
      background: linear-gradient(135deg, var(--dark-color), var(--primary-color));
      padding: 25px;
      text-align: center;
      box-shadow: var(--shadow);
      position: relative;
      color: white;
      border-bottom: 3px solid var(--accent-color);
    }
    
    header h1 {
      margin: 0;
      font-size: 2.2em;
      color: var(--accent-color);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      font-weight: 700;
    }
    
    nav {
      background-color: var(--primary-color);
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 12px;
      flex-wrap: wrap;
      position: sticky;
      top: 0;
      z-index: 90;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    
    nav a {
      color: var(--text-color);
      text-decoration: none;
      padding: 8px 20px;
      background-color: rgba(255,255,255,0.15);
      border-radius: 30px;
      transition: var(--transition);
      font-weight: 500;
      font-size: 0.95em;
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    nav a:hover {
      background-color: var(--accent-color);
      color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .section {
      padding: 30px 15px;
      background-color: white;
      margin: 20px auto;
      border-radius: 10px;
      box-shadow: var(--shadow);
      max-width: 1200px;
      position: relative;
      overflow: hidden;
    }
    
    .section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(to bottom, var(--accent-color), var(--primary-color));
    }
    
    .section h2 {
      color: var(--primary-color);
      text-align: center;
      margin-bottom: 25px;
      font-size: 1.8em;
      position: relative;
      padding-bottom: 10px;
    }
    
    .section h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background-color: var(--accent-color);
      border-radius: 3px;
    }
    
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 25px;
      padding: 10px;
    }
    
    .product {
      background-color: white;
      border-radius: 12px;
      padding: 0;
      text-align: center;
      position: relative;
      transition: var(--transition);
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      overflow: hidden;
      border: 1px solid #eee;
    }
    
    .product:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 25px rgba(0,0,0,0.1);
    }
    
    .product:hover .product-img-container::after {
      opacity: 1;
    }
    
    .product-img-container {
      position: relative;
      overflow: hidden;
      height: 220px;
    }
    
    .product-img-container::after {
      content: 'عرض التفاصيل';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: 10px;
      background-color: rgba(0,0,0,0.7);
      color: white;
      font-weight: bold;
      opacity: 0;
      transition: var(--transition);
    }
    
    .product img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }
    
    .product:hover img {
      transform: scale(1.05);
    }
    
    .product-info {
      padding: 15px;
    }
    
    .product h3 {
      margin: 10px 0;
      color: var(--primary-color);
      font-size: 1.2em;
      font-weight: 700;
    }
    
    .product p {
      margin: 8px 0;
      font-size: 0.95em;
      color: #666;
    }
    
    .product .price {
      font-weight: bold;
      font-size: 1.2em;
      color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    
    .product .price::before {
      content: 'ج.م';
      font-size: 0.8em;
      color: var(--accent-color);
    }
    
    .product-id {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: var(--accent-color);
      padding: 6px 10px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 0.9em;
      z-index: 2;
    }
    
    .product-actions {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }
    
    .product-actions button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.9em;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .product-actions button:hover {
      background-color: var(--dark-color);
      transform: translateY(-2px);
    }
    
    .product-actions button i {
      font-size: 1.1em;
    }
    
    .controls {
      margin: 20px auto;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      background-color: var(--light-color);
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
    }
    
    .controls input, 
    .controls button, 
    .controls textarea, 
    .controls select {
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 1em;
      font-family: 'Tajawal', sans-serif;
      transition: var(--transition);
    }
    
    .controls input, 
    .controls textarea {
      width: 250px;
      background-color: white;
      color: #333;
    }
    
    .controls input:focus, 
    .controls textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
    }
    
    .controls button {
      background-color: var(--primary-color);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
      font-weight: bold;
      min-width: 120px;
      border: none;
    }
    
    .controls button:hover {
      background-color: var(--dark-color);
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .footer {
      text-align: center;
      padding: 25px;
      background-color: var(--primary-color);
      margin-top: 40px;
      font-size: 1em;
      color: white;
      box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
    }
    
    #time {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      margin: 20px auto;
      text-align: center;
      box-shadow: var(--shadow);
      font-size: 1.2em;
      color: var(--primary-color);
      border: 1px solid #eee;
    }
    
    /* معرض الصور المعدل */
    .gallery-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      backdrop-filter: blur(5px);
    }
    
    .gallery-content {
      position: relative;
      margin: auto;
      padding: 20px;
      max-width: 90%;
      max-height: 90%;
      top: 50%;
      transform: translateY(-50%);
      text-align: center;
    }
    
    .gallery-img {
      max-width: 100%;
      max-height: 70vh;
      border-radius: 8px;
      box-shadow: 0 0 30px rgba(0,0,0,0.5);
      border: 2px solid var(--accent-color);
      animation: zoomIn 0.3s;
    }
    
    .gallery-desc {
      background: rgba(26, 35, 126, 0.9);
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
      font-size: 1em;
      box-shadow: var(--shadow);
      color: white;
      animation: fadeInUp 0.4s;
    }
    
    .gallery-nav {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 15px;
      box-sizing: border-box;
      transform: translateY(-50%);
    }
    
    .gallery-close {
      position: absolute;
      top: 25px;
      right: 30px;
      color: white;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
      background: rgba(0,0,0,0.5);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .gallery-close:hover {
      color: var(--accent-color);
      transform: rotate(90deg) scale(1.1);
      background: rgba(0,0,0,0.7);
    }
    
    .gallery-btn {
      background: rgba(255, 215, 0, 0.8);
      color: #000;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      transition: var(--transition);
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .gallery-btn:hover {
      background: var(--accent-color);
      transform: scale(1.1);
    }
    
    .gallery-counter {
      position: absolute;
      top: 20px;
      left: 30px;
      color: var(--accent-color);
      font-size: 18px;
      font-weight: bold;
      background: rgba(0,0,0,0.7);
      padding: 5px 15px;
      border-radius: 20px;
    }
    
    /* سلة التسوق المحسنة */
    .cart-icon {
      position: fixed;
      top: 20px;
      left: 20px;
      background: var(--primary-color);
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      z-index: 100;
      transition: var(--transition);
      border: 2px solid var(--accent-color);
    }
    
    .cart-icon:hover {
      transform: scale(1.1);
      background: var(--dark-color);
    }
    
    .cart-icon .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--accent-color);
      color: #000;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border: 2px solid white;
    }
    
    .cart-container {
      position: fixed;
      top: 90px;
      left: 20px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      width: 350px;
      box-shadow: 0 5px 25px rgba(0,0,0,0.15);
      z-index: 100;
      max-height: 70vh;
      overflow-y: auto;
      border: 2px solid var(--accent-color);
      transition: var(--transition);
      display: none;
    }
    
    .cart-title {
      color: var(--primary-color);
      text-align: center;
      margin-bottom: 15px;
      font-size: 1.4em;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--accent-color);
    }
    
    .cart-items {
      margin-bottom: 15px;
      max-height: 300px;
      overflow-y: auto;
      padding-right: 5px;
    }
    
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px dashed #ddd;
    }
    
    .cart-item-name {
      flex: 2;
      text-align: right;
      color: #333;
      font-weight: 500;
    }
    
    .cart-item-price {
      flex: 1;
      text-align: left;
      color: var(--primary-color);
      font-weight: bold;
    }
    
    .cart-total {
      font-weight: bold;
      text-align: center;
      margin-top: 15px;
      color: var(--primary-color);
      font-size: 1.3em;
      padding: 12px;
      background: var(--light-color);
      border-radius: 8px;
    }
    
    .cart-controls {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .cart-controls select {
      flex-grow: 1;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ddd;
      background-color: white;
      color: #333;
      font-family: 'Tajawal', sans-serif;
    }
    
    .cart-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.95em;
    }
    
    .cart-btn:hover {
      background: var(--dark-color);
      transform: translateY(-3px);
    }
    
    /* أزرار الفاتورة المحسنة */
    .action-buttons {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 90;
    }
    
    .action-button {
      background: var(--primary-color);
      color: white;
      border: none;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 24px;
      transition: var(--transition);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid white;
    }
    
    .action-button:hover {
      transform: scale(1.1);
    }
    
    .action-button.main {
      background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
    }
    
    .action-button.pdf {
      background: linear-gradient(135deg, #d32f2f, #f44336);
    }
    
    .action-button.email {
      background: linear-gradient(135deg, #1976d2, #2196f3);
    }
    
    .action-button.whatsapp {
      background: linear-gradient(135deg, #4caf50, #8bc34a);
    }
    
    /* قائمة الأزرار المخفية */
    .action-menu {
      position: absolute;
      bottom: 70px;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      padding: 10px;
      z-index: 95;
      display: none;
      animation: fadeInUp 0.3s;
    }
    
    .action-menu button {
      background: white;
      border: none;
      padding: 10px 20px;
      border-radius: 30px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: var(--transition);
      font-family: 'Tajawal', sans-serif;
      font-size: 14px;
      color: #333;
      margin: 5px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      width: 100%;
    }
    
    .action-menu button:hover {
      background: #f5f5f5;
      transform: translateX(-5px);
    }
    
    /* إظهار القائمة عند النقر على الزر الرئيسي */
    .action-buttons:hover .action-menu,
    .action-menu:hover {
      display: block;
    }
    
    /* نافذة الفاتورة */
    .invoice-modal {
      display: none;
      position: fixed;
      z-index: 1100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      overflow: auto;
      backdrop-filter: blur(5px);
    }
    
    .invoice-content {
      background-color: white;
      margin: 50px auto;
      padding: 30px;
      border-radius: 12px;
      width: 85%;
      max-width: 850px;
      box-shadow: 0 0 30px rgba(0,0,0,0.3);
      border: 2px solid var(--accent-color);
      position: relative;
      animation: fadeInUp 0.4s;
    }
    
    .invoice-header {
      text-align: center;
      margin-bottom: 30px;
      color: var(--primary-color);
      border-bottom: 3px solid var(--accent-color);
      padding-bottom: 15px;
    }
    
    .invoice-header h2 {
      font-size: 2em;
      margin-bottom: 10px;
    }
    
    .invoice-header p {
      font-size: 1.1em;
      margin: 5px 0;
      color: #555;
    }
    
    .invoice-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    
    .invoice-table th, 
    .invoice-table td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
      font-size: 1em;
    }
    
    .invoice-table th {
      background-color: var(--primary-color);
      color: white;
      font-size: 1.1em;
    }
    
    .invoice-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    .invoice-table tr:hover {
      background-color: #f1f1f1;
    }
    
    .invoice-summary {
      text-align: left;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 2px dashed var(--accent-color);
      font-size: 1.1em;
    }
    
    .invoice-summary p {
      margin: 10px 0;
      color: #333;
    }
    
    .invoice-summary .total {
      font-weight: bold;
      font-size: 1.3em;
      color: var(--primary-color);
    }
    
    .close-invoice {
      position: absolute;
      top: 15px;
      right: 20px;
      color: var(--primary-color);
      font-size: 30px;
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .close-invoice:hover {
      color: var(--dark-color);
      transform: rotate(180deg);
    }
    
    .print-invoice {
      background: linear-gradient(135deg, var(--accent-color), #ffc107);
      color: #000;
      border: none;
      padding: 12px 30px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 20px;
      transition: var(--transition);
      font-size: 1.1em;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 25px auto 0;
    }
    
    .print-invoice:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    
    /* تنبيهات */
    .alert {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      background: #4caf50;
      color: white;
      border-radius: 8px;
      z-index: 1200;
      display: none;
      font-size: 1em;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      animation: slideIn 0.4s, fadeOut 0.4s 2.5s;
      border-left: 4px solid #2e7d32;
      max-width: 350px;
    }
    
    .alert.error {
      background: #f44336;
      border-left: 4px solid #c62828;
    }
    
    .alert.warning {
      background: #ff9800;
      border-left: 4px solid #f57c00;
    }
    
    @keyframes slideIn {
      from {right: -350px; opacity: 0;}
      to {right: 20px; opacity: 1;}
    }
    
    @keyframes fadeOut {
      from {opacity: 1;}
      to {opacity: 0;}
    }
    
    /* تأثيرات الحركة */
    @keyframes pulse {
      0% {transform: scale(1);}
      50% {transform: scale(1.05);}
      100% {transform: scale(1);}
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes zoomIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }
    
    /* نمط نموذج الاتصال */
    .contact-form-container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      max-width: 600px;
      margin: 30px auto;
      box-shadow: var(--shadow);
      animation: fadeInUp 0.4s;
      border: 1px solid #eee;
    }
    
    .contact-form-container h2 {
      color: var(--primary-color);
      text-align: center;
      margin-bottom: 25px;
      font-size: 1.8em;
      position: relative;
      padding-bottom: 10px;
    }
    
    .contact-form-container h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background-color: var(--accent-color);
      border-radius: 3px;
    }
    
    .contact-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    
    .contact-form label {
      color: var(--primary-color);
      font-weight: 500;
      text-align: right;
    }
    
    .contact-form input,
    .contact-form textarea {
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-family: 'Tajawal', sans-serif;
      transition: var(--transition);
      font-size: 1em;
    }
    
    .contact-form input:focus,
    .contact-form textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
    }
    
    .contact-form textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    .submit-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 30px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.1em;
      transition: var(--transition);
      margin-top: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .submit-btn:hover {
      background: var(--dark-color);
      transform: translateY(-3px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    /* الطباعة */
    @media print {
      body * {
        visibility: hidden;
      }
      .invoice-content, .invoice-content * {
        visibility: visible;
      }
      .invoice-content {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        max-width: 100%;
        box-shadow: none;
        border: none;
        margin: 0;
        padding: 20px;
      }
      .action-buttons, .close-invoice {
        display: none;
      }
    }
    
    /* للشاشات الصغيرة */
    @media (max-width: 768px) {
      header h1 {
        font-size: 1.8em;
      }
      
      nav {
        gap: 8px;
      }
      
      nav a {
        padding: 6px 12px;
        font-size: 0.85em;
      }
      
      .products {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      }
      
      .cart-container {
        width: 90%;
        left: 5%;
      }
      
      .invoice-content {
        width: 95%;
        padding: 15px;
      }
      
      .invoice-table th, 
      .invoice-table td {
        padding: 8px;
        font-size: 0.9em;
      }
    }
</style>
</head>
<body>
<header>
<h1>ورشة متجر علي بابا أحمد الدكروري<br/>هندسة وتجارة العدد وقطع الغيار</h1>
</header>
<nav>
<a href="https://www.youtube.com/@ahmed-eldakrory" target="_blank"><i class="fab fa-youtube"></i> يوتيوب</a>
<a href="https://www.facebook.com/profile.php?id=61569878923724" target="_blank"><i class="fab fa-facebook"></i> فيسبوك</a>
<a href="#men"><i class="fas fa-laptop-code"></i> إلكترونيات وبرمجة</a>
<a href="#women"><i class="fas fa-tools"></i> عدد وقطع غيار</a>
<a href="#kids"><i class="fas fa-shield-alt"></i> خدمات أمنية</a>
<a href="#clock"><i class="far fa-clock"></i> الساعة</a>
<a href="#contact"><i class="fas fa-envelope"></i> تواصل معنا</a>
<a href="#" id="loadBtn"><i class="fas fa-sync-alt"></i> استرجاع البيانات</a>
</nav>

<!-- سلة التسوق المحسنة -->
<div class="cart-icon" id="cartIcon">
    <i class="fas fa-shopping-cart"></i>
    <div class="badge" id="cartBadge">0</div>
</div>
<div class="cart-container" id="cartContainer">
<div class="cart-title"><i class="fas fa-shopping-basket"></i> سلة التسوق</div>
<div class="cart-items" id="cartItems">
<!-- العناصر المضافة إلى السلة تظهر هنا -->
</div>
<div class="cart-total">المجموع: <span id="cartTotal">0</span> جنيه</div>
<div class="cart-controls">
<select id="productSelect">
<option value="">اختر منتج للحذف</option>
</select>
<button class="cart-btn" id="removeBtn"><i class="fas fa-trash"></i> حذف</button>
</div>
<button class="cart-btn" id="invoiceBtn"><i class="fas fa-file-invoice"></i> عرض الفاتورة</button>
</div>

<!-- قسم أكترونيات وأجهزة منزلية سوفت وير وبرمجه-->
<section class="section" id="men">
<h2><i class="fas fa-laptop-code"></i> قسم إلكترونيات وأجهزة منزلية</h2>
<div class="controls"><input onkeyup="filterProducts(this.value, 'men')" placeholder="ابحث باسم المنتج..." type="text"/></div>
<div class="products" id="menProducts"></div>
</section>

<!-- قسم تجارة العدد والادوات وقطع غيار-->
<section class="section" id="women">
<h2><i class="fas fa-tools"></i> قسم تجارة العدد والأدوات</h2>
<div class="controls"><input onkeyup="filterProducts(this.value, 'women')" placeholder="ابحث باسم المنتج..." type="text"/></div>
<div class="products" id="womenProducts"></div>
</section>

<!-- خدمات مصرفية أمن ونظافة -->
<section class="section" id="kids">
<h2><i class="fas fa-shield-alt"></i> قسم الخدمات الأمنية</h2>
<div class="controls"><input onkeyup="filterProducts(this.value, 'kids')" placeholder="ابحث باسم المنتج..." type="text"/></div>
<div class="products" id="kidsProducts"></div>
</section>

<!-- قسم الساعة -->
<section class="section" id="clock">
<h2><i class="far fa-clock"></i> الساعة ومواقيت الصلاة</h2>
<div id="time">جارٍ تحميل الساعة...</div>
</section>

<!-- نموذج الاتصال -->
<section class="section" id="contact">
<div class="contact-form-container">
<h2><i class="fas fa-envelope"></i> تواصل معنا</h2>
<form class="contact-form" id="contactForm">
<div class="form-group">
<label for="name">الاسم الكامل</label>
<input id="name" name="name" placeholder="أدخل اسمك الكامل" required type="text"/>
</div>
<div class="form-group">
<label for="phone">رقم الهاتف</label>
<input id="phone" name="phone" placeholder="أدخل رقم هاتفك" required type="tel"/>
</div>
<div class="form-group">
<label for="subject">الموضوع</label>
<textarea id="subject" name="subject" placeholder="اكتب موضوع رسالتك هنا" required rows="4"></textarea>
</div>
<button class="submit-btn" type="submit"><i class="fas fa-paper-plane"></i> إرسال الرسالة</button>
</form>
</div>
</section>

<!-- معرض الصور -->
<div class="gallery-modal" id="galleryModal">
<span class="gallery-close"><i class="fas fa-times"></i></span>
<div class="gallery-counter" id="galleryCounter"></div>
<div class="gallery-content">
<img class="gallery-img" id="galleryImage" src=""/>
<div class="gallery-desc" id="galleryDesc"></div>
</div>
<div class="gallery-nav">
<button class="gallery-btn" id="prevBtn"><i class="fas fa-chevron-right"></i></button>
<button class="gallery-btn" id="nextBtn"><i class="fas fa-chevron-left"></i></button>
</div>
</div>

<!-- نموذج الفاتورة -->
<div class="invoice-modal" id="invoiceModal">
<div class="invoice-content">
<span class="close-invoice"><i class="fas fa-times"></i></span>
<div class="invoice-header">
<h2>فاتورة شراء</h2>
<p>متجر علي بابا أحمد الدكروري</p>
<p id="invoiceDate"></p>
<p id="invoiceNumber"></p>
</div>
<table class="invoice-table">
<thead>
<tr>
<th>رقم المنتج</th>
<th>اسم المنتج</th>
<th>السعر</th>
<th>الكمية</th>
<th>المجموع</th>
</tr>
</thead>
<tbody id="invoiceItems">
<!-- عناصر الفاتورة تظهر هنا -->
</tbody>
</table>
<div class="invoice-summary">
<p>المجموع الكلي: <span id="invoiceTotal">0</span> جنيه</p>
</div>
<button class="print-invoice" onclick="printInvoice()">
<i class="fas fa-print"></i> طباعة الفاتورة
</button>
</div>
</div>

<!-- أزرار الفاتورة المحسنة -->
<div class="action-buttons">
<button class="action-button main" id="mainActionButton">
<i class="fas fa-cog"></i>
</button>
<div class="action-menu">
<button class="action-button pdf" id="pdfBtn">
<i class="fas fa-file-pdf"></i> PDF
</button>
<button class="action-button email" id="emailBtn">
<i class="fas fa-envelope"></i> إيميل
</button>
<button class="action-button whatsapp" id="whatsappBtn">
<i class="fab fa-whatsapp"></i> واتساب
</button>
</div>
</div>

<!-- تنبيه -->
<div class="alert" id="alert"></div>

<div class="footer">
    جميع الحقوق محفوظة &copy; متجر علي بابا أحمد الدكروري 2025
</div>

<script>
    // متغيرات التطبيق
    let products = {
      men: [],
      women: [],
      kids: []
    };
    let cart = [];
    let currentInvoiceNumber = 1000;
    let lastProductId = 0;

    // متغيرات معرض الصور
    let currentGallery = {
      images: [],
      descriptions: [],
      sizes: [],
      currentIndex: 0
    };

    // دالة لإظهار التنبيه
    function showAlert(message, type = 'success') {
      const alert = document.getElementById('alert');
      alert.textContent = message;
      alert.className = 'alert';
      alert.classList.add(type === 'success' ? 'alert' : type === 'error' ? 'error' : 'warning');
      alert.style.display = 'block';
      setTimeout(() => {
        alert.style.display = 'none';
      }, 3000);
    }

    // دالة لحفظ البيانات في localStorage
    function saveData() {
      const data = {
        products: products,
        cart: cart,
        lastProductId: lastProductId,
        currentInvoiceNumber: currentInvoiceNumber
      };
      localStorage.setItem('storeDataVersion3', JSON.stringify(data));
      showAlert('تم حفظ جميع البيانات بنجاح', 'success');
    }

    // دالة لتحميل البيانات من localStorage
    function loadData() {
      const savedData = localStorage.getItem('storeDataVersion3');
      if (savedData) {
        const data = JSON.parse(savedData);
        products = data.products || { men: [], women: [], kids: [] };
        cart = data.cart || [];
        lastProductId = data.lastProductId || 0;
        currentInvoiceNumber = data.currentInvoiceNumber || 1000;
        
        renderAllProducts();
        updateCart();
        showAlert('تم استرجاع جميع البيانات بنجاح', 'success');
      } else {
        showAlert('لا توجد بيانات محفوظة', 'error');
      }
    }

    // دالة لعرض جميع المنتجات
    function renderAllProducts() {
      renderProducts('men');
      renderProducts('women');
      renderProducts('kids');
    }

    // دالة لعرض المنتجات في قسم معين
    function renderProducts(sectionId) {
      const container = document.getElementById(`${sectionId}Products`);
      container.innerHTML = '';
      
      products[sectionId].forEach(product => {
        const productHTML = `
          <div class="product" 
               data-id="${product.id}" 
               data-section="${sectionId}"
               data-images='${JSON.stringify(product.images)}' 
               data-desc="${product.description.replace(/"/g, '&quot;')}"
               data-sizes="${product.sizes}">
            <div class="product-id">${product.id}</div>
            <div class="product-img-container">
              <img src="${product.images[0]}" alt="${product.name}">
            </div>
            <div class="product-info">
              <h3>${product.name}</h3>
              <p class="price">${product.price.toFixed(2)}</p>
              <div class="product-actions">
                <button onclick="addToCart(${product.id}, '${sectionId}')">
                  <i class="fas fa-cart-plus"></i> أضف للسلة
                </button>
              </div>
            </div>
          </div>
        `;
        container.innerHTML += productHTML;
      });
    }

    // دالة لإضافة منتج إلى السلة
    function addToCart(productId, sectionId) {
      const product = products[sectionId].find(p => p.id === productId);
      if (!product) return;
      
      const existingItem = cart.find(item => item.id === productId && item.section === sectionId);
      if (existingItem) {
        existingItem.quantity++;
      } else {
        cart.push({
          id: productId,
          section: sectionId,
          name: product.name,
          price: product.price,
          quantity: 1
        });
      }
      
      updateCart();
      showAlert(`تمت إضافة ${product.name} إلى السلة`, 'success');
      
      // تأثير اهتزاز للسلة
      const cartIcon = document.getElementById('cartIcon');
      cartIcon.classList.add('animate__animated', 'animate__tada');
      setTimeout(() => {
        cartIcon.classList.remove('animate__animated', 'animate__tada');
      }, 1000);
    }

    // دالة لتحديث عرض السلة
    function updateCart() {
      const cartItems = document.getElementById('cartItems');
      const cartTotal = document.getElementById('cartTotal');
      const productSelect = document.getElementById('productSelect');
      const cartBadge = document.getElementById('cartBadge');
      
      cartItems.innerHTML = '';
      productSelect.innerHTML = '<option value="">اختر منتج للحذف</option>';
      
      let total = 0;
      
      cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        
        cartItems.innerHTML += `
          <div class="cart-item">
            <div class="cart-item-name">${item.name}</div>
            <div class="cart-item-price">${item.quantity} × ${item.price.toFixed(2)} ج</div>
          </div>
        `;
        
        productSelect.innerHTML += `
          <option value="${index}">${item.name} (${item.quantity})</option>
        `;
      });
      
      cartTotal.textContent = total.toFixed(2);
      cartBadge.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      // إظهار/إخفاء البادج إذا كانت السلة فارغة
      if (cart.length === 0) {
        cartBadge.style.display = 'none';
      } else {
        cartBadge.style.display = 'flex';
      }
    }

    // دالة لحذف منتج من السلة
    function removeFromCart() {
      const productSelect = document.getElementById('productSelect');
      const selectedIndex = parseInt(productSelect.value);
      
      if (isNaN(selectedIndex)) {
        showAlert("الرجاء اختيار منتج للحذف", 'error');
        return;
      }
      
      const removedItem = cart[selectedIndex];
      cart.splice(selectedIndex, 1);
      updateCart();
      showAlert(`تم حذف ${removedItem.name} من السلة`, 'success');
    }

    // دالة لعرض الفاتورة
    function showInvoice() {
      if (cart.length === 0) {
        showAlert("السلة فارغة، أضف منتجات أولاً", 'error');
        return;
      }
      
      const invoiceItems = document.getElementById('invoiceItems');
      const invoiceTotal = document.getElementById('invoiceTotal');
      const invoiceDate = document.getElementById('invoiceDate');
      const invoiceNumber = document.getElementById('invoiceNumber');
      
      invoiceItems.innerHTML = '';
      let total = 0;
      
      cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        
        invoiceItems.innerHTML += `
          <tr>
            <td>${item.id}</td>
            <td>${item.name}</td>
            <td>${item.price.toFixed(2)} ج</td>
            <td>${item.quantity}</td>
            <td>${itemTotal.toFixed(2)} ج</td>
          </tr>
        `;
      });
      
      invoiceTotal.textContent = total.toFixed(2);
      invoiceDate.textContent = new Date().toLocaleDateString('ar-EG', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
      
      invoiceNumber.textContent = `رقم الفاتورة: INV-${currentInvoiceNumber++}`;
      
      document.getElementById('invoiceModal').style.display = 'block';
      saveData(); // حفظ رقم الفاتورة الجديد
    }

    // دالة لطباعة الفاتورة
    function printInvoice() {
      window.print();
    }

    // دالة لحفظ الفاتورة كPDF
    function saveAsPDF() {
      showAlert("سيتم حفظ الفاتورة كملف PDF", 'success');
      // في الواقع، هذه تحتاج إلى مكتبة مثل jsPDF أو html2pdf
      // هنا نضع واجهة مستخدم فقط
      setTimeout(() => {
        showAlert("تم حفظ الفاتورة كملف PDF بنجاح", 'success');
      }, 2000);
    }

    // دالة لإرسال الفاتورة بالبريد
    function sendEmail() {
      const email = 'aaldkrwry08@gmail.com';
      const subject = 'فاتورة شراء من متجر علي بابا أحمد الدكروري';
      let body = 'تفاصيل الفاتورة:\n\n';
      
      cart.forEach(item => {
        body += `${item.name} - ${item.quantity} × ${item.price} = ${item.quantity * item.price}\n`;
      });
      
      body += `\nالمجموع الكلي: ${cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)} جنيه`;
      
      window.open(`mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);
      showAlert("جارٍ فتح بريد الإرسال...", 'success');
    }

    // دالة لإرسال الفاتورة عبر واتساب
    function sendWhatsApp() {
      const numbers = ['01221152075', '01500053127'];
      let message = 'مرحباً، أريد شراء هذه المنتجات:\n\n';
      
      cart.forEach(item => {
        message += `${item.name} - الكمية: ${item.quantity}\n`;
      });
      
      message += `\nالمجموع الكلي: ${cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)} جنيه`;
      
      // إرسال إلى أول رقم (يمكن تعديله ليعرض خيارات)
      window.open(`https://wa.me/2${numbers[0]}?text=${encodeURIComponent(message)}`);
      showAlert("جارٍ فتح واتساب...", 'success');
    }

    // دالة لإغلاق الفاتورة
    function closeInvoice() {
      document.getElementById('invoiceModal').style.display = 'none';
    }

    // دالة لعرض الساعة
    function updateClock() {
      const now = new Date();
      const timeString = now.toLocaleTimeString('ar-EG');
      document.getElementById('time').innerHTML = `
        <div style="font-size: 1.5em; margin-bottom: 10px;">
          <i class="far fa-clock"></i> ${timeString}
        </div>
        <div style="font-size: 1.2em;">
          ${now.toLocaleDateString('ar-EG', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'})}
        </div>
      `;
    }

    // دالة لفتح معرض الصور
    function openGallery(images, description, sizes) {
      currentGallery.images = images;
      currentGallery.descriptions = Array(images.length).fill(description);
      currentGallery.sizes = Array(images.length).fill(sizes);
      currentGallery.currentIndex = 0;
      
      updateGallery();
      document.getElementById('galleryModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    // دالة لتحديث معرض الصور
    function updateGallery() {
      const galleryImg = document.getElementById('galleryImage');
      const galleryDesc = document.getElementById('galleryDesc');
      const galleryCounter = document.getElementById('galleryCounter');
      
      galleryImg.src = currentGallery.images[currentGallery.currentIndex];
      galleryDesc.innerHTML = `
        ${currentGallery.descriptions[currentGallery.currentIndex]}<br><br>
        <strong>المقاسات المتاحة:</strong> ${currentGallery.sizes[currentGallery.currentIndex]}
      `;
      galleryCounter.textContent = `${currentGallery.currentIndex + 1} / ${currentGallery.images.length}`;
    }

    // دالة لإغلاق معرض الصور
    function closeGallery() {
      document.getElementById('galleryModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // دالة للصورة التالية
    function nextImage() {
      currentGallery.currentIndex = (currentGallery.currentIndex + 1) % currentGallery.images.length;
      updateGallery();
    }

    // دالة للصورة السابقة
    function prevImage() {
      currentGallery.currentIndex = (currentGallery.currentIndex - 1 + currentGallery.images.length) % currentGallery.images.length;
      updateGallery();
    }

    // تهيئة التطبيق
    document.addEventListener('DOMContentLoaded', function() {
      // أحداث معرض الصور
      document.querySelector('.gallery-close').addEventListener('click', closeGallery);
      document.getElementById('prevBtn').addEventListener('click', prevImage);
      document.getElementById('nextBtn').addEventListener('click', nextImage);

      // أحداث السلة والفاتورة
      document.getElementById('removeBtn').addEventListener('click', removeFromCart);
      document.getElementById('invoiceBtn').addEventListener('click', showInvoice);
      document.querySelector('.close-invoice').addEventListener('click', closeInvoice);

      // أحداث الحفظ والتحميل
      document.getElementById('loadBtn').addEventListener('click', loadData);

      // أحداث أزرار الفاتورة
      document.getElementById('pdfBtn').addEventListener('click', saveAsPDF);
      document.getElementById('emailBtn').addEventListener('click', sendEmail);
      document.getElementById('whatsappBtn').addEventListener('click', sendWhatsApp);

      // فتح المعرض عند النقر على منتج
      document.addEventListener('click', function(e) {
        const product = e.target.closest('.product');
        if (product) {
          const images = JSON.parse(product.getAttribute('data-images'));
          const desc = product.getAttribute('data-desc');
          const sizes = product.getAttribute('data-sizes');
          openGallery(images, desc, sizes);
        }
      });

      // إظهار/إخفاء سلة التسوق عند النقر على الأيقونة
      document.getElementById('cartIcon').addEventListener('click', function() {
        const cartContainer = document.getElementById('cartContainer');
        cartContainer.style.display = cartContainer.style.display === 'block' ? 'none' : 'block';
      });

      // إغلاق سلة التسوق عند النقر خارجها
      document.addEventListener('click', function(e) {
        const cartContainer = document.getElementById('cartContainer');
        const cartIcon = document.getElementById('cartIcon');
        
        if (e.target !== cartIcon && !cartIcon.contains(e.target)) {
          if (e.target !== cartContainer && !cartContainer.contains(e.target)) {
            cartContainer.style.display = 'none';
          }
        }
      });

      // إغلاق المعرض عند النقر خارج الصورة
      document.getElementById('galleryModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeGallery();
        }
      });

      // التنقل بين الصور باستخدام لوحة المفاتيح
      document.addEventListener('keydown', function(e) {
        if (document.getElementById('galleryModal').style.display === 'block') {
          if (e.key === 'ArrowRight') nextImage();
          if (e.key === 'ArrowLeft') prevImage();
          if (e.key === 'Escape') closeGallery();
        }
        
        if (document.getElementById('invoiceModal').style.display === 'block' && e.key === 'Escape') {
          closeInvoice();
        }
      });

      // تحميل المنتجات من جدول البيانات
      loadProductsFromSheet();
    });

    // تحديث الساعة كل ثانية
    setInterval(updateClock, 1000);
    updateClock();
  
    // دالة لتحميل المنتجات من جدول بيانات Google
    async function loadProductsFromSheet() {
      try {
        const url = "https://opensheet.elk.sh/14PagQwAs6PDFYloRNQL6GBYcf7liw3QwWn7oc57PK1s/products";
        const response = await fetch(url);
        const data = await response.json();

        if (!Array.isArray(data)) {
          console.error("البيانات غير صالحة:", data);
          return;
        }

        // إعادة تهيئة المنتجات
        products = { men: [], women: [], kids: [] };

        // تعيين أكثر دقة للأقسام
        const sectionMap = {
          "Electronics & Software": "men",
          "Tools & Spare Parts": "women",
          "Financial, Security & Cleaning": "kids",
          "إلكترونيات وبرمجيات": "men",
          "عدد وقطع غيار": "women",
          "خدمات مصرفية وأمن ونظافة": "kids"
        };

        data.forEach(item => {
          try {
            // معالجة الصور
            const images = [item["main_image"], ...(item["images"] ? item["images"].split(',') : [])]
              .filter(img => img && img.trim())
              .map(img => {
                img = img.trim();
                if (img.includes("drive.google.com")) {
                  const match = img.match(/\/d\/([a-zA-Z0-9_-]+)/) || 
                               img.match(/id=([a-zA-Z0-9_-]+)/) ||
                               img.match(/\/uc\?id=([a-zA-Z0-9_-]+)/);
                  if (match && match[1]) {
                    return `https://drive.google.com/thumbnail?id=${match[1]}&sz=w1000`;
                  }
                }
                return img;
              });

            // تحديد القسم
            let sectionKey = "men"; // افتراضي
            const itemSection = item["section"]?.trim();
            
            if (itemSection) {
              // البحث عن أفضل تطابق
              for (const [key, value] of Object.entries(sectionMap)) {
                if (itemSection.replace(/\s+/g, '').toLowerCase() === key.replace(/\s+/g, '').toLowerCase()) {
                  sectionKey = value;
                  break;
                }
              }
            }

            // إنشاء المنتج
            const product = {
              id: parseInt(item["id"]) || ++lastProductId,
              name: item["name"] || "منتج بدون اسم",
              price: parseFloat(item["price"]) || 0,
              description: item["description"] || "لا يوجد وصف",
              images: images.length ? images : ["https://via.placeholder.com/300?text=No+Image"],
              sizes: item["sizes"] || "غير محدد"
            };

            // إضافة المنتج إلى القسم المناسب
            if (products[sectionKey]) {
              products[sectionKey].push(product);
            } else {
              console.warn(`قسم غير معروف: ${sectionKey}، تم إضافة المنتج إلى قسم الرجال كإفتراضي`);
              products.men.push(product);
            }

            // تحديث آخر معرف منتج
            if (product.id > lastProductId) {
              lastProductId = product.id;
            }
          } catch (error) {
            console.error("خطأ في معالجة المنتج:", item, error);
          }
        });

        renderAllProducts();
        showAlert("تم تحميل المنتجات بنجاح", "success");
      } catch (error) {
        console.error("فشل في تحميل المنتجات:", error);
        showAlert("فشل في تحميل المنتجات من جدول البيانات", "error");
      }
    }

    // معالجة نموذج الاتصال
    document.getElementById("contactForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const form = e.target;
      const data = new FormData(form);

      fetch("https://script.google.com/macros/s/AKfycbxBbWZmKgRfp_ajFc0znyKeINqHOfN5iXrHKUat_2UtAIlE4fvxOH-Dxs8X7wd7iF90/exec", {
          method: "POST",
          body: data
      })
      .then(response => response.text())
      .then(result => {
          showAlert("✅ تم إرسال رسالتك بنجاح!", "success");
          form.reset();
      })
      .catch(error => {
          showAlert("❌ حدث خطأ أثناء الإرسال، حاول لاحقًا.", "error");
          console.error(error);
      });
    });

    // دالة تصفية المنتجات
    function filterProducts(query, sectionId) {
      const normalizedQuery = query.trim().toLowerCase();
      const container = document.getElementById(sectionId + 'Products');
      const allProducts = Array.from(container.querySelectorAll('.product'));

      allProducts.forEach(product => {
        const title = product.querySelector('h3').textContent.trim().toLowerCase();
        if (title.includes(normalizedQuery) || normalizedQuery === '') {
          product.style.display = 'block';
        } else {
          product.style.display = 'none';
        }
      });
    }
</script>
</body>
</html>
